var Fe=Object.defineProperty,Te=Object.defineProperties;var Ie=Object.getOwnPropertyDescriptors;var oe=Object.getOwnPropertySymbols;var Re=Object.prototype.hasOwnProperty,Be=Object.prototype.propertyIsEnumerable;var le=(d,r,a)=>r in d?Fe(d,r,{enumerable:!0,configurable:!0,writable:!0,value:a}):d[r]=a,O=(d,r)=>{for(var a in r||(r={}))Re.call(r,a)&&le(d,a,r[a]);if(oe)for(var a of oe(r))Be.call(r,a)&&le(d,a,r[a]);return d},$=(d,r)=>Te(d,Ie(r));import{d as A,y as Ne,o as w,c as C,h as Q,z as De,f as N,F as j,t as J,j as Ae,n as D,A as Le,B as Y,C as Pe,D as Oe,e as _,q as K,G as ue,H as $e,I as je,b as G,x as Ge}from"./app.2920bb8e.js";var ee={};(function d(r,a,o,m){var h=!!(r.Worker&&r.Blob&&r.Promise&&r.OffscreenCanvas&&r.OffscreenCanvasRenderingContext2D&&r.HTMLCanvasElement&&r.HTMLCanvasElement.prototype.transferControlToOffscreen&&r.URL&&r.URL.createObjectURL);function u(){}function M(t){var e=a.exports.Promise,s=e!==void 0?e:r.Promise;return typeof s=="function"?new s(t):(t(u,u),null)}var x=function(){var t=Math.floor(16.666666666666668),e,s,n={},c=0;return typeof requestAnimationFrame=="function"&&typeof cancelAnimationFrame=="function"?(e=function(l){var i=Math.random();return n[i]=requestAnimationFrame(function f(y){c===y||c+t-1<y?(c=y,delete n[i],l()):n[i]=requestAnimationFrame(f)}),i},s=function(l){n[l]&&cancelAnimationFrame(n[l])}):(e=function(l){return setTimeout(l,t)},s=function(l){return clearTimeout(l)}),{frame:e,cancel:s}}(),b=function(){var t,e,s={};function n(c){function l(i,f){c.postMessage({options:i||{},callback:f})}c.init=function(f){var y=f.transferControlToOffscreen();c.postMessage({canvas:y},[y])},c.fire=function(f,y,I){if(e)return l(f,null),e;var p=Math.random().toString(36).slice(2);return e=M(function(R){function k(v){v.data.callback===p&&(delete s[p],c.removeEventListener("message",k),e=null,I(),R())}c.addEventListener("message",k),l(f,p),s[p]=k.bind(null,{data:{callback:p}})}),e},c.reset=function(){c.postMessage({reset:!0});for(var f in s)s[f](),delete s[f]}}return function(){if(t)return t;if(!o&&h){var c=["var CONFETTI, SIZE = {}, module = {};","("+d.toString()+")(this, module, true, SIZE);","onmessage = function(msg) {","  if (msg.data.options) {","    CONFETTI(msg.data.options).then(function () {","      if (msg.data.callback) {","        postMessage({ callback: msg.data.callback });","      }","    });","  } else if (msg.data.reset) {","    CONFETTI.reset();","  } else if (msg.data.resize) {","    SIZE.width = msg.data.resize.width;","    SIZE.height = msg.data.resize.height;","  } else if (msg.data.canvas) {","    SIZE.width = msg.data.canvas.width;","    SIZE.height = msg.data.canvas.height;","    CONFETTI = module.exports.create(msg.data.canvas);","  }","}"].join(`
`);try{t=new Worker(URL.createObjectURL(new Blob([c])))}catch(l){return typeof console!==void 0&&typeof console.warn=="function"&&console.warn("\u{1F38A} Could not load worker",l),null}n(t)}return t}}(),W={particleCount:50,angle:90,spread:45,startVelocity:45,decay:.9,gravity:1,drift:0,ticks:200,x:.5,y:.5,shapes:["square","circle"],zIndex:100,colors:["#26ccff","#a25afd","#ff5e7e","#88ff5a","#fcff42","#ffa62d","#ff36ff"],disableForReducedMotion:!1,scalar:1};function z(t,e){return e?e(t):t}function E(t){return t!=null}function g(t,e,s){return z(t&&E(t[e])?t[e]:W[e],s)}function F(t){return t<0?0:Math.floor(t)}function V(t,e){return Math.floor(Math.random()*(e-t))+t}function T(t){return parseInt(t,16)}function de(t){return t.map(he)}function he(t){var e=String(t).replace(/[^0-9a-f]/gi,"");return e.length<6&&(e=e[0]+e[0]+e[1]+e[1]+e[2]+e[2]),{r:T(e.substring(0,2)),g:T(e.substring(2,4)),b:T(e.substring(4,6))}}function fe(t){var e=g(t,"origin",Object);return e.x=g(e,"x",Number),e.y=g(e,"y",Number),e}function me(t){t.width=document.documentElement.clientWidth,t.height=document.documentElement.clientHeight}function ge(t){var e=t.getBoundingClientRect();t.width=e.width,t.height=e.height}function ve(t){var e=document.createElement("canvas");return e.style.position="fixed",e.style.top="0px",e.style.left="0px",e.style.pointerEvents="none",e.style.zIndex=t,e}function ye(t,e,s,n,c,l,i,f,y){t.save(),t.translate(e,s),t.rotate(l),t.scale(n,c),t.arc(0,0,1,i,f,y),t.restore()}function pe(t){var e=t.angle*(Math.PI/180),s=t.spread*(Math.PI/180);return{x:t.x,y:t.y,wobble:Math.random()*10,wobbleSpeed:Math.min(.11,Math.random()*.1+.05),velocity:t.startVelocity*.5+Math.random()*t.startVelocity,angle2D:-e+(.5*s-Math.random()*s),tiltAngle:(Math.random()*(.75-.25)+.25)*Math.PI,color:t.color,shape:t.shape,tick:0,totalTicks:t.ticks,decay:t.decay,drift:t.drift,random:Math.random()+2,tiltSin:0,tiltCos:0,wobbleX:0,wobbleY:0,gravity:t.gravity*3,ovalScalar:.6,scalar:t.scalar}}function be(t,e){e.x+=Math.cos(e.angle2D)*e.velocity+e.drift,e.y+=Math.sin(e.angle2D)*e.velocity+e.gravity,e.wobble+=e.wobbleSpeed,e.velocity*=e.decay,e.tiltAngle+=.1,e.tiltSin=Math.sin(e.tiltAngle),e.tiltCos=Math.cos(e.tiltAngle),e.random=Math.random()+2,e.wobbleX=e.x+10*e.scalar*Math.cos(e.wobble),e.wobbleY=e.y+10*e.scalar*Math.sin(e.wobble);var s=e.tick++/e.totalTicks,n=e.x+e.random*e.tiltCos,c=e.y+e.random*e.tiltSin,l=e.wobbleX+e.random*e.tiltCos,i=e.wobbleY+e.random*e.tiltSin;return t.fillStyle="rgba("+e.color.r+", "+e.color.g+", "+e.color.b+", "+(1-s)+")",t.beginPath(),e.shape==="circle"?t.ellipse?t.ellipse(e.x,e.y,Math.abs(l-n)*e.ovalScalar,Math.abs(i-c)*e.ovalScalar,Math.PI/10*e.wobble,0,2*Math.PI):ye(t,e.x,e.y,Math.abs(l-n)*e.ovalScalar,Math.abs(i-c)*e.ovalScalar,Math.PI/10*e.wobble,0,2*Math.PI):(t.moveTo(Math.floor(e.x),Math.floor(e.y)),t.lineTo(Math.floor(e.wobbleX),Math.floor(c)),t.lineTo(Math.floor(l),Math.floor(i)),t.lineTo(Math.floor(n),Math.floor(e.wobbleY))),t.closePath(),t.fill(),e.tick<e.totalTicks}function Me(t,e,s,n,c){var l=e.slice(),i=t.getContext("2d"),f,y,I=M(function(p){function R(){f=y=null,i.clearRect(0,0,n.width,n.height),c(),p()}function k(){o&&!(n.width===m.width&&n.height===m.height)&&(n.width=t.width=m.width,n.height=t.height=m.height),!n.width&&!n.height&&(s(t),n.width=t.width,n.height=t.height),i.clearRect(0,0,n.width,n.height),l=l.filter(function(v){return be(i,v)}),l.length?f=x.frame(k):R()}f=x.frame(k),y=R});return{addFettis:function(p){return l=l.concat(p),I},canvas:t,promise:I,reset:function(){f&&x.cancel(f),y&&y()}}}function te(t,e){var s=!t,n=!!g(e||{},"resize"),c=g(e,"disableForReducedMotion",Boolean),l=h&&!!g(e||{},"useWorker"),i=l?b():null,f=s?me:ge,y=t&&i?!!t.__confetti_initialized:!1,I=typeof matchMedia=="function"&&matchMedia("(prefers-reduced-motion)").matches,p;function R(v,U,q){for(var B=g(v,"particleCount",F),L=g(v,"angle",Number),P=g(v,"spread",Number),S=g(v,"startVelocity",Number),we=g(v,"decay",Number),xe=g(v,"gravity",Number),_e=g(v,"drift",Number),ae=g(v,"colors",de),Ce=g(v,"ticks",Number),ne=g(v,"shapes"),ke=g(v,"scalar"),ie=fe(v),se=B,X=[],Ee=t.width*ie.x,Se=t.height*ie.y;se--;)X.push(pe({x:Ee,y:Se,angle:L,spread:P,startVelocity:S,color:ae[se%ae.length],shape:ne[V(0,ne.length)],ticks:Ce,decay:we,gravity:xe,drift:_e,scalar:ke}));return p?p.addFettis(X):(p=Me(t,X,f,U,q),p.promise)}function k(v){var U=c||g(v,"disableForReducedMotion",Boolean),q=g(v,"zIndex",Number);if(U&&I)return M(function(S){S()});s&&p?t=p.canvas:s&&!t&&(t=ve(q),document.body.appendChild(t)),n&&!y&&f(t);var B={width:t.width,height:t.height};i&&!y&&i.init(t),y=!0,i&&(t.__confetti_initialized=!0);function L(){if(i){var S={getBoundingClientRect:function(){if(!s)return t.getBoundingClientRect()}};f(S),i.postMessage({resize:{width:S.width,height:S.height}});return}B.width=B.height=null}function P(){p=null,n&&r.removeEventListener("resize",L),s&&t&&(document.body.removeChild(t),t=null,y=!1)}return n&&r.addEventListener("resize",L,!1),i?i.fire(v,B,P):R(v,B,P)}return k.reset=function(){i&&i.reset(),p&&p.reset()},k}var Z;function re(){return Z||(Z=te(null,{useWorker:!0,resize:!0})),Z}a.exports=function(){return re().apply(this,arguments)},a.exports.reset=function(){re().reset()},a.exports.create=te})(function(){return typeof window!="undefined"?window:typeof self!="undefined"?self:this||{}}(),ee,!1);var H=ee.exports;ee.exports.create;const We=A({__name:"Confetti",props:{passed:{type:Boolean}},setup(d){const r=d;function a(){const o={colors:["#5D8C7B","#F2D091","#F2A679","#D9695F","#8C4646"],shapes:["square"],ticks:500};H($(O({},o),{particleCount:80,spread:100,origin:{y:0}})),setTimeout(()=>{H($(O({},o),{particleCount:50,angle:60,spread:80,origin:{x:0}}))},250),setTimeout(()=>{H($(O({},o),{particleCount:50,angle:120,spread:80,origin:{x:1}}))},400)}return Ne(()=>r.passed,o=>{o&&setTimeout(a,300)},{flush:"post"}),(o,m)=>(w(),C("div"))}}),ce=Q(!1);De(ce);const ze={key:0,"i-mdi-flag":"","text-red":""},Ve={key:0,"i-mdi-mine":""},Ze={key:1,"font-600":""},Ue=A({__name:"MineBlock",props:{block:null},emits:["lrclick"],setup(d,{emit:r}){function a(h){h.buttons===3&&r("lrclick",h)}const o=["text-transparent","text-blue-500","text-green-500","text-yellow-500","text-orange-500","text-red-500","text-purple-500","text-pink-500","text-teal-500"];function m(h){return h.flagged?"bg-gray-500/20":h.revealed?h.mine?"bg-red-500/50":o[h.adjacentMines]:"bg-gray-500/20 hover:bg-gray-500/50"}return(h,u)=>(w(),C("button",{flex:"~","items-center":"","justify-center":"","min-w-8":"","min-h-8":"",m:"1px",border:"0.5 gray-400/20",class:D(m(d.block)),onMousedown:a},[d.block.flagged?(w(),C("div",ze)):d.block.revealed||N(ce)?(w(),C(j,{key:1},[d.block.mine?(w(),C("div",Ve)):(w(),C("div",Ze,J(d.block.adjacentMines),1))],64)):Ae("",!0)],34))}}),qe=[[1,1],[1,0],[1,-1],[0,-1],[-1,-1],[-1,0],[-1,1],[0,1]];class Xe{constructor(r,a,o){this.width=r,this.height=a,this.mines=o,this.state=Q(),this.reset()}get board(){return this.state.value.board}get blocks(){return this.state.value.board.flat()}reset(r=this.width,a=this.height,o=this.mines){this.width=r,this.height=a,this.mines=o,this.state.value={mineGenerated:!1,status:"ready",board:Array.from({length:this.height},(m,h)=>Array.from({length:this.width},(u,M)=>({x:M,y:h,adjacentMines:0,revealed:!1})))}}randomRange(r,a){return Math.random()*(a-r)+r}randomInt(r,a){return Math.round(this.randomRange(r,a))}generateMines(r,a){const o=()=>{const m=this.randomInt(0,this.width-1),h=this.randomInt(0,this.height-1),u=r[h][m];return Math.abs(a.x-u.x)<=1&&Math.abs(a.y-u.y)<=1||u.mine?!1:(u.mine=!0,!0)};Array.from({length:this.mines},()=>null).forEach(()=>{let m=!1;for(;!m;)m=o()}),this.updateNumbers()}updateNumbers(){this.board.forEach(r=>{r.forEach(a=>{a.mine||this.getSiblings(a).forEach(o=>{o.mine&&(a.adjacentMines+=1)})})})}expendZero(r){r.adjacentMines||this.getSiblings(r).forEach(a=>{a.revealed||(a.flagged||(a.revealed=!0),this.expendZero(a))})}onRightClick(r){this.state.value.status==="play"&&(r.revealed||(r.flagged=!r.flagged))}onClick(r){if(this.state.value.status==="ready"&&(this.state.value.status="play",this.state.value.startMS=+new Date),!(this.state.value.status!=="play"||r.flagged)){if(this.state.value.mineGenerated||(this.generateMines(this.board,r),this.state.value.mineGenerated=!0),r.revealed=!0,r.mine){this.onGameOver("lost");return}this.expendZero(r)}}getSiblings(r){return qe.map(([a,o])=>{const m=r.x+a,h=r.y+o;if(!(m<0||m>=this.width||h<0||h>=this.height))return this.board[h][m]}).filter(Boolean)}showAllMines(){this.board.flat().forEach(r=>{r.mine&&(r.revealed=!0)})}checkGameState(){if(!this.state.value.mineGenerated||this.state.value.status!=="play")return;this.board.flat().some(a=>!a.mine&&!a.revealed)||this.onGameOver("won")}autoExpand(r){if(this.state.value.status!=="play"||r.flagged)return;const a=this.getSiblings(r),o=a.reduce((u,M)=>u+(M.flagged?1:0),0),m=a.reduce((u,M)=>u+(!M.revealed&&!M.flagged?1:0),0);o===r.adjacentMines&&a.forEach(u=>{u.revealed||u.flagged||(u.revealed=!0,this.expendZero(u),u.mine&&this.onGameOver("lost"))});const h=r.adjacentMines-o;m===h&&a.forEach(u=>{!u.revealed&&!u.flagged&&(u.flagged=!0)})}onGameOver(r){this.state.value.status=r,this.state.value.endMS=+Date.now(),r==="lost"&&(this.showAllMines(),setTimeout(()=>{alert("lost")},10))}}const Ye=K(" \u626B\u96F7 "),He={flex:"~ gap1","justify-center":"","my-5":""},Je={flex:"~ gap-10","justify-center":""},Ke={"font-mono":"","text-2xl":"",flex:"~ gap-1","items-center":""},Qe=_("div",{"i-carbon-timer":""},null,-1),et={"font-mono":"","text-2xl":"",flex:"~ gap-1","items-center":""},tt=_("div",{"i-mdi-mine":""},null,-1),rt={"mt-3":"","w-full":"","overflow-auto":""},at=A({__name:"index",setup(d){const r=new Xe(9,9,10),a=Q("easy"),o=Le(),m=Y(()=>{var x,b;return Math.round((((x=r.state.value.endMS)!=null?x:+o.value)-((b=r.state.value.startMS)!=null?b:+o.value))/1e3)});Pe("vuesweeper-state",r.state);const h=Y(()=>r.board),u=Y(()=>r.state.value.mineGenerated?r.blocks.reduce((x,b)=>x-(b.flagged?1:0),r.mines):r.mines);function M(x){switch(a.value=x,x){case"easy":r.reset(9,9,10);break;case"medium":r.reset(16,16,40);break;case"hard":r.reset(20,20,100);break;case"everyhard":r.reset(25,25,200);break}}return r.reset(9,9,10),Oe(()=>{r.checkGameState()}),(x,b)=>{const W=Ue,z=We;return w(),C("div",null,[Ye,_("div",He,[_("button",{btn:"",onClick:b[0]||(b[0]=E=>N(r).reset())}," \u518D\u6765\u4E00\u6B21 "),_("button",{btn:"",class:D(a.value==="easy"?"active":""),onClick:b[1]||(b[1]=E=>M("easy"))}," \u7B80\u5355 ",2),_("button",{btn:"",class:D(a.value==="medium"?"active":""),onClick:b[2]||(b[2]=E=>M("medium"))}," \u4E00\u822C ",2),_("button",{btn:"",class:D(a.value==="hard"?"active":""),onClick:b[3]||(b[3]=E=>M("hard"))}," \u56F0\u96BE ",2),_("button",{btn:"",class:D(a.value==="everyhard"?"active":""),onClick:b[4]||(b[4]=E=>M("everyhard"))}," \u6781\u96BE ",2)]),_("div",Je,[_("div",Ke,[Qe,K(" "+J(m.value),1)]),_("div",et,[tt,K(" "+J(u.value),1)])]),_("div",rt,[(w(!0),C(j,null,ue(h.value,(E,g)=>(w(),C("div",{key:g,flex:"~","items-center":"","justify-center":"","w-max":"",ma:""},[(w(!0),C(j,null,ue(E,(F,V)=>(w(),$e(W,{key:V,block:F,onClick:T=>N(r).onClick(F),onLrclick:T=>N(r).autoExpand(F),onContextmenu:je(T=>N(r).onRightClick(F),["prevent"])},null,8,["block","onClick","onLrclick","onContextmenu"]))),128))]))),128))]),G(z,{passed:N(r).state.value.status==="won"},null,8,["passed"])])}}}),nt=A({__name:"index",setup(d){return(r,a)=>(w(),C("div",null,[G(at)]))}}),ot=A({__name:"game",setup(d){return(r,a)=>(w(),C(j,null,[G(Ge),G(nt)],64))}});export{ot as default};
